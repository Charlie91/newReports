webpackHotUpdate(0,{"./src/views/Dashboard/Dashboard.js":function(module,exports,__webpack_require__){"use strict";eval("\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = __webpack_require__(\"./node_modules/react/react.js\");\n\nvar _react2 = _interopRequireDefault(_react);\n\n__webpack_require__(\"./node_modules/react-select/dist/react-select.css\");\n\n__webpack_require__(\"./src/views/Dashboard/style.css\");\n\nvar _api_paths = __webpack_require__(\"./src/utils/api_paths.js\");\n\nvar _utils = __webpack_require__(\"./src/utils/utils.js\");\n\nvar _DataCard = __webpack_require__(\"./src/views/Dashboard/DataCard.js\");\n\nvar _DataCard2 = _interopRequireDefault(_DataCard);\n\nvar _reactstrap = __webpack_require__(\"./node_modules/reactstrap/dist/reactstrap.es.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Dashboard = function (_Component) {\n    _inherits(Dashboard, _Component);\n\n    function Dashboard(props) {\n        _classCallCheck(this, Dashboard);\n\n        var _this = _possibleConstructorReturn(this, (Dashboard.__proto__ || Object.getPrototypeOf(Dashboard)).call(this, props));\n\n        _this.state = {\n            dropdownOpen: false,\n            objects: []\n        };\n        return _this;\n    }\n\n    _createClass(Dashboard, [{\n        key: 'getAvailableCities',\n        value: function getAvailableCities() {\n            var _this2 = this;\n\n            //получаем города в которых доступны объекты\n            var id = 1;\n            var options = {\n                method: 'GET',\n                credentials: 'include',\n                mode: 'cors'\n            };\n            return (0, _utils.ajaxRequest)(_api_paths.API.cities + id, options).then(function (data) {\n                var formattedData = data.map(function (item) {\n                    item.checked = true;\n                    item.value = item.label = item.city_name;\n                    item.ID = item.id;\n                    delete item.city_name;\n                    delete item.id;\n                    delete item.priority;\n                    return item;\n                });\n                _this2.props.upState('availableCities', formattedData);\n            }).catch(function (error) {\n                return console.log(error);\n            });\n        }\n    }, {\n        key: 'getObjects',\n        value: function getObjects() {\n            var _this3 = this;\n\n            //https://repo.re-ports.ru/app_test/Objects?conceptId=-1&cityId=-2\n            var options = {\n                method: 'GET',\n                credentials: 'include',\n                mode: 'cors'\n            };\n            var conceptID = 1;\n            if (this.state.cities.length) {\n                var cities = this.state.cities;\n                if (!this.state.objects.length) {\n                    var arr = [];\n                    cities.forEach(function (item) {\n                        (0, _utils.ajaxRequest)(_api_paths.API.objects + '?conceptId=' + conceptID + '&cityId=' + item.ID, options).then(function (data) {\n                            data.forEach(function (object) {\n                                (0, _utils.ajaxRequest)(_api_paths.API.objectsData + '?objId=' + object.id, options).then(function (payData) {\n                                    object.data = payData;\n                                    _this3.setState({ objects: arr });\n                                }).catch(function (error) {\n                                    return console.log(error);\n                                });\n                            });\n                            //let arr = this.state.objects;\n                            data.forEach(function (item) {\n                                return arr.push(item);\n                            });\n                        }).catch(function (error) {\n                            return console.log(error);\n                        });\n                    });\n                }\n            }\n        }\n    }, {\n        key: 'renderObjects',\n        value: function renderObjects() {\n            var _this4 = this;\n\n            if (this.state.objects.length) {\n                var objectsForRender = this.state.objects.filter(function (object) {\n                    var cityId = object.city_id;\n                    return _this4.state.cities.some(function (city) {\n                        if (city.ID === cityId && city.checked) return true;\n                    });\n                });\n                return _react2.default.createElement(\n                    _reactstrap.Row,\n                    null,\n                    objectsForRender.map(function (item, i) {\n                        return _react2.default.createElement(_DataCard2.default, { key: i, obj: item });\n                    })\n                );\n            }\n        }\n    }, {\n        key: 'componentDidMount',\n        value: function componentDidMount() {\n            this.getAvailableCities();\n        }\n    }, {\n        key: 'componentWillReceiveProps',\n        value: function componentWillReceiveProps(nextprops) {\n            var _this5 = this;\n\n            if (nextprops.cities.length) {\n                // if(nextprops.cities.length && !this.state.cities) {  - костыль\n                console.log(1);\n                this.setState({ cities: nextprops.cities }, function () {\n                    return _this5.getObjects();\n                });\n            }\n        }\n    }, {\n        key: 'render',\n        value: function render() {\n            return _react2.default.createElement(\n                'div',\n                { className: 'animated fadeIn' },\n                this.renderObjects()\n            );\n        }\n    }]);\n\n    return Dashboard;\n}(_react.Component);\n\nexports.default = Dashboard;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9zcmMvdmlld3MvRGFzaGJvYXJkL0Rhc2hib2FyZC5qcy5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy9zcmMvdmlld3MvRGFzaGJvYXJkL0Rhc2hib2FyZC5qcz9lOTExIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwgeyBDb21wb25lbnQgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgJ3JlYWN0LXNlbGVjdC9kaXN0L3JlYWN0LXNlbGVjdC5jc3MnO1xuaW1wb3J0ICcuL3N0eWxlLmNzcyc7XG5pbXBvcnQge0FQSX0gZnJvbSAnLi8uLi8uLi91dGlscy9hcGlfcGF0aHMnO1xuaW1wb3J0IHthamF4UmVxdWVzdH0gZnJvbSAnLi8uLi8uLi91dGlscy91dGlscyc7XG5pbXBvcnQgRGF0YUNhcmQgZnJvbSAnLi9EYXRhQ2FyZCc7XG5cbmltcG9ydCB7XG4gICAgUm93XG59IGZyb20gXCJyZWFjdHN0cmFwXCI7XG5cblxuXG5jbGFzcyBEYXNoYm9hcmQgZXh0ZW5kcyBDb21wb25lbnQge1xuICAgIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgICAgICAgIGRyb3Bkb3duT3BlbjogZmFsc2UsXG4gICAgICAgICAgICBvYmplY3RzOltdXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgZ2V0QXZhaWxhYmxlQ2l0aWVzKCl7ICAgIC8v0L/QvtC70YPRh9Cw0LXQvCDQs9C+0YDQvtC00LAg0LIg0LrQvtGC0L7RgNGL0YUg0LTQvtGB0YLRg9C/0L3RiyDQvtCx0YrQtdC60YLRi1xuICAgICAgICBsZXQgaWQgPSAxO1xuICAgICAgICBsZXQgb3B0aW9ucyA9IHtcbiAgICAgICAgICAgIG1ldGhvZDonR0VUJyxcbiAgICAgICAgICAgIGNyZWRlbnRpYWxzOidpbmNsdWRlJyxcbiAgICAgICAgICAgIG1vZGU6ICdjb3JzJ1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gYWpheFJlcXVlc3QoQVBJLmNpdGllcytpZCxvcHRpb25zKVxuICAgICAgICAgICAgLnRoZW4oIGRhdGEgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBmb3JtYXR0ZWREYXRhID0gZGF0YS5tYXAoIGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICBpdGVtLmNoZWNrZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLnZhbHVlID0gaXRlbS5sYWJlbCA9IGl0ZW0uY2l0eV9uYW1lO1xuICAgICAgICAgICAgICAgICAgICBpdGVtLklEID0gaXRlbS5pZDtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGl0ZW0uY2l0eV9uYW1lO1xuICAgICAgICAgICAgICAgICAgICBkZWxldGUgaXRlbS5pZDtcbiAgICAgICAgICAgICAgICAgICAgZGVsZXRlIGl0ZW0ucHJpb3JpdHk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wcm9wcy51cFN0YXRlKCdhdmFpbGFibGVDaXRpZXMnLGZvcm1hdHRlZERhdGEpXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmNhdGNoKCBlcnJvciA9PiBjb25zb2xlLmxvZyhlcnJvcikpXG4gICAgfVxuXG4gICAgZ2V0T2JqZWN0cygpIHtcbiAgICAgICAgLy9odHRwczovL3JlcG8ucmUtcG9ydHMucnUvYXBwX3Rlc3QvT2JqZWN0cz9jb25jZXB0SWQ9LTEmY2l0eUlkPS0yXG4gICAgICAgIGxldCBvcHRpb25zID0ge1xuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIGNyZWRlbnRpYWxzOiAnaW5jbHVkZScsXG4gICAgICAgICAgICBtb2RlOiAnY29ycydcbiAgICAgICAgfTtcbiAgICAgICAgbGV0IGNvbmNlcHRJRCA9IDE7XG4gICAgICAgIGlmICh0aGlzLnN0YXRlLmNpdGllcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGxldCBjaXRpZXMgPSB0aGlzLnN0YXRlLmNpdGllcztcbiAgICAgICAgICAgIGlmKCF0aGlzLnN0YXRlLm9iamVjdHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgbGV0IGFyciA9IFtdO1xuICAgICAgICAgICAgICAgIGNpdGllcy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICAgICAgICAgICAgICBhamF4UmVxdWVzdChBUEkub2JqZWN0cyArICc/Y29uY2VwdElkPScgKyBjb25jZXB0SUQgKyAnJmNpdHlJZD0nICsgaXRlbS5JRCwgb3B0aW9ucylcbiAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGRhdGEgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEuZm9yRWFjaChvYmplY3QgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhamF4UmVxdWVzdChBUEkub2JqZWN0c0RhdGEgKyAnP29iaklkPScgKyBvYmplY3QuaWQsIG9wdGlvbnMpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAudGhlbiggcGF5RGF0YSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0LmRhdGEgPSBwYXlEYXRhO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe29iamVjdHM6YXJyfSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4gY29uc29sZS5sb2coZXJyb3IpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vbGV0IGFyciA9IHRoaXMuc3RhdGUub2JqZWN0cztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhLmZvckVhY2goaXRlbSA9PiBhcnIucHVzaChpdGVtKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IGNvbnNvbGUubG9nKGVycm9yKSlcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG5cblxuICAgIHJlbmRlck9iamVjdHMoKXtcbiAgICAgICAgaWYodGhpcy5zdGF0ZS5vYmplY3RzLmxlbmd0aCl7XG4gICAgICAgICAgICBsZXQgb2JqZWN0c0ZvclJlbmRlciA9IHRoaXMuc3RhdGUub2JqZWN0cy5maWx0ZXIoIG9iamVjdCA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGNpdHlJZCA9IG9iamVjdC5jaXR5X2lkO1xuICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLnN0YXRlLmNpdGllcy5zb21lKCBjaXR5ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYoY2l0eS5JRCA9PT0gY2l0eUlkICYmIGNpdHkuY2hlY2tlZClyZXR1cm4gdHJ1ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHJldHVybihcbiAgICAgICAgICAgICAgICA8Um93PlxuICAgICAgICAgICAgICAgICAgICB7b2JqZWN0c0ZvclJlbmRlci5tYXAoIChpdGVtLGkpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gPERhdGFDYXJkIGtleT17aX0gb2JqPXtpdGVtfSAvPlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICApfVxuICAgICAgICAgICAgICAgIDwvUm93PlxuICAgICAgICAgICAgKVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29tcG9uZW50RGlkTW91bnQoKXtcbiAgICAgICAgdGhpcy5nZXRBdmFpbGFibGVDaXRpZXMoKTtcbiAgICB9XG5cbiAgICBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRwcm9wcyl7XG4gICAgICAgIGlmKG5leHRwcm9wcy5jaXRpZXMubGVuZ3RoKSB7IC8vIGlmKG5leHRwcm9wcy5jaXRpZXMubGVuZ3RoICYmICF0aGlzLnN0YXRlLmNpdGllcykgeyAgLSDQutC+0YHRgtGL0LvRjFxuICAgICAgICAgICAgY29uc29sZS5sb2coMSk7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtjaXRpZXM6IG5leHRwcm9wcy5jaXRpZXN9LCAoKSA9PiB0aGlzLmdldE9iamVjdHMoKSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImFuaW1hdGVkIGZhZGVJblwiPlxuICAgICAgICAgICAgICAgIHt0aGlzLnJlbmRlck9iamVjdHMoKX1cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICApXG4gICAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBEYXNoYm9hcmQ7XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gc3JjL3ZpZXdzL0Rhc2hib2FyZC9EYXNoYm9hcmQuanMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQUE7QUFDQTs7O0FBQUE7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQ0E7OztBQUNBO0FBQ0E7Ozs7Ozs7OztBQUtBOzs7QUFDQTtBQUFBO0FBQ0E7QUFEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRkE7QUFGQTtBQU1BO0FBQ0E7OztBQUNBO0FBQUE7QUFDQTtBQURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBS0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSEE7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUFJQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUhBO0FBT0E7QUFDQTs7O0FBRUE7QUFDQTtBQUNBOzs7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBOzs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBREE7QUFJQTs7Ozs7O0FBR0EiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./src/views/Dashboard/Dashboard.js\n")}});